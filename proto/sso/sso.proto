syntax = "proto3";

package auth;

option go_package = "tuzov.sso.v1;ssov1";

// Auth is service for managing permissions and roles.
service Auth {
   rpc Register (RegisterRequest) returns (RegisterResponse);
   rpc Login (LoginRequest) returns (LoginResponse);
   rpc IsAdmin (IsAdminRequest) returns (IsAdminResponse);
   rpc ValidateToken(ValidateTokenRequest) returns (ValidateTokenResponse);
   rpc CreateAdmin (CreateAdminRequest) returns (CreateAdminResponse);
   rpc BanUser (BanUserRequest) returns (BanUserResponse);
}

message ValidateTokenRequest {
  string token = 1;
}

message RegisterRequest {
   string email = 1;      // Email of the user to register
   string password = 2;   // Password of the user
   string nickname = 3;   // Nickname of the user
}

message RegisterResponse {
   int64 user_id = 1;     // ID of registered user
   string nickname = 2;   // Nickname of registered user
}

message ValidateTokenResponse {
  bool valid = 1;         // Indicates whether the token is valid
  int64 user_id = 2;      // ID of the user associated with the token
  string role = 3;        // Role of the user
  string nickname = 4;    // Nickname of the user
}

message LoginRequest {
   string email = 1;
   string password = 2;
   int32 app_id = 3;
}

message LoginResponse {
    string token = 1;
    string nickname = 2;   // Чтобы фронту сразу знать ник
}

message IsAdminRequest {
    int64 user_id = 1;
}

message IsAdminResponse {
    bool is_admin = 1;
}

message CreateAdminRequest {
  string email = 1;
  string password = 2;
  string nickname = 3;
  int64 requesting_user_id = 4;
}

message CreateAdminResponse {
  int64 user_id = 1;
  string nickname = 2;
}

message BanUserRequest {
  int64 user_id = 1;
  int64 requesting_user_id = 2;
  string reason = 3;
}

message BanUserResponse {
  bool success = 1;
}
